<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Riddle::Client</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Riddle::Client</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/vendor/riddle/lib/riddle/0_9_9/client_rb.html">
                vendor/riddle/lib/riddle/0.9.9/client.rb
                </a>
        <br />
                <a href="../../files/vendor/riddle/lib/riddle/client/filter_rb.html">
                vendor/riddle/lib/riddle/client/filter.rb
                </a>
        <br />
                <a href="../../files/vendor/riddle/lib/riddle/client/response_rb.html">
                vendor/riddle/lib/riddle/client/response.rb
                </a>
        <br />
                <a href="../../files/vendor/riddle/lib/riddle/client/message_rb.html">
                vendor/riddle/lib/riddle/client/message.rb
                </a>
        <br />
                <a href="../../files/vendor/riddle/lib/riddle/client_rb.html">
                vendor/riddle/lib/riddle/client.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
This class was heavily based on the existing <a
href="Client.html">Client</a> API by Dmytro Shteflyuk and Alexy Kovyrin.
Their code worked fine, I just wanted something a bit more Ruby-ish (ie.
lowercase and underscored method names). I also have used a few helper
classes, just to neaten things up.
</p>
<p>
Feel free to use it wherever. Send bug reports, patches, comments and
suggestions to pat at freelancing-gods dot com.
</p>
<p>
Most properties of the client are accessible through attribute accessors,
and where relevant use symboles instead of the long constants common in
other clients. Some examples:
</p>
<pre>
  client.sort_mode  = :extended
  client.sort_by    = &quot;birthday DESC&quot;
  client.match_mode = :extended
</pre>
<p>
To add a filter, you will need to create a <a
href="Client/Filter.html">Filter</a> object:
</p>
<pre>
  client.filters &lt;&lt; Riddle::Client::Filter.new(&quot;birthday&quot;,
    Time.at(1975, 1, 1).to_i..Time.at(1985, 1, 1).to_i, false)
</pre>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000345">add_override</a>&nbsp;&nbsp;
      <a href="#M000338">append_query</a>&nbsp;&nbsp;
      <a href="#M000347">close</a>&nbsp;&nbsp;
      <a href="#M000334">connection</a>&nbsp;&nbsp;
      <a href="#M000333">connection=</a>&nbsp;&nbsp;
      <a href="#M000341">excerpts</a>&nbsp;&nbsp;
      <a href="#M000343">keywords</a>&nbsp;&nbsp;
      <a href="#M000335">new</a>&nbsp;&nbsp;
      <a href="#M000346">open</a>&nbsp;&nbsp;
      <a href="#M000340">query</a>&nbsp;&nbsp;
      <a href="#M000336">reset</a>&nbsp;&nbsp;
      <a href="#M000339">run</a>&nbsp;&nbsp;
      <a href="#M000337">set_anchor</a>&nbsp;&nbsp;
      <a href="#M000344">status</a>&nbsp;&nbsp;
      <a href="#M000342">update</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">

    <div id="class-list">
      <h3 class="section-bar">Classes and Modules</h3>

      Class <a href="Client/Filter.html" class="link">Riddle::Client::Filter</a><br />
Class <a href="Client/Message.html" class="link">Riddle::Client::Message</a><br />
Class <a href="Client/Response.html" class="link">Riddle::Client::Response</a><br />

    </div>

    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">Commands</td>
          <td>=</td>
          <td class="context-item-value">{       :search   =&gt; 0, # SEARCHD_COMMAND_SEARCH       :excerpt  =&gt; 1, # SEARCHD_COMMAND_EXCERPT       :update   =&gt; 2, # SEARCHD_COMMAND_UPDATE       :keywords =&gt; 3, # SEARCHD_COMMAND_KEYWORDS       :persist  =&gt; 4, # SEARCHD_COMMAND_PERSIST       :status   =&gt; 5, # SEARCHD_COMMAND_STATUS       :query    =&gt; 6</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">Versions</td>
          <td>=</td>
          <td class="context-item-value">{       :search   =&gt; 0x113, # VER_COMMAND_SEARCH       :excerpt  =&gt; 0x100, # VER_COMMAND_EXCERPT       :update   =&gt; 0x101, # VER_COMMAND_UPDATE       :keywords =&gt; 0x100, # VER_COMMAND_KEYWORDS       :status   =&gt; 0x100, # VER_COMMAND_STATUS       :query    =&gt; 0x100</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">Statuses</td>
          <td>=</td>
          <td class="context-item-value">{       :ok      =&gt; 0, # SEARCHD_OK       :error   =&gt; 1, # SEARCHD_ERROR       :retry   =&gt; 2, # SEARCHD_RETRY       :warning =&gt; 3</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">MatchModes</td>
          <td>=</td>
          <td class="context-item-value">{       :all        =&gt; 0, # SPH_MATCH_ALL       :any        =&gt; 1, # SPH_MATCH_ANY       :phrase     =&gt; 2, # SPH_MATCH_PHRASE       :boolean    =&gt; 3, # SPH_MATCH_BOOLEAN       :extended   =&gt; 4, # SPH_MATCH_EXTENDED       :fullscan   =&gt; 5, # SPH_MATCH_FULLSCAN       :extended2  =&gt; 6</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">RankModes</td>
          <td>=</td>
          <td class="context-item-value">{       :proximity_bm25 =&gt; 0, # SPH_RANK_PROXIMITY_BM25       :bm25           =&gt; 1, # SPH_RANK_BM25       :none           =&gt; 2, # SPH_RANK_NONE       :wordcount      =&gt; 3, # SPH_RANK_WORDCOUNT       :proximity      =&gt; 4, # SPH_RANK_PROXIMITY       :match_any      =&gt; 5, # SPH_RANK_MATCHANY       :fieldmask      =&gt; 6</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">SortModes</td>
          <td>=</td>
          <td class="context-item-value">{       :relevance     =&gt; 0, # SPH_SORT_RELEVANCE       :attr_desc     =&gt; 1, # SPH_SORT_ATTR_DESC       :attr_asc      =&gt; 2, # SPH_SORT_ATTR_ASC       :time_segments =&gt; 3, # SPH_SORT_TIME_SEGMENTS       :extended      =&gt; 4, # SPH_SORT_EXTENDED       :expr          =&gt; 5</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">AttributeTypes</td>
          <td>=</td>
          <td class="context-item-value">{       :integer    =&gt; 1, # SPH_ATTR_INTEGER       :timestamp  =&gt; 2, # SPH_ATTR_TIMESTAMP       :ordinal    =&gt; 3, # SPH_ATTR_ORDINAL       :bool       =&gt; 4, # SPH_ATTR_BOOL       :float      =&gt; 5, # SPH_ATTR_FLOAT       :bigint     =&gt; 6, # SPH_ATTR_BIGINT       :multi      =&gt; 0x40000000</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">GroupFunctions</td>
          <td>=</td>
          <td class="context-item-value">{       :day      =&gt; 0, # SPH_GROUPBY_DAY       :week     =&gt; 1, # SPH_GROUPBY_WEEK       :month    =&gt; 2, # SPH_GROUPBY_MONTH       :year     =&gt; 3, # SPH_GROUPBY_YEAR       :attr     =&gt; 4, # SPH_GROUPBY_ATTR       :attrpair =&gt; 5</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">FilterTypes</td>
          <td>=</td>
          <td class="context-item-value">{       :values       =&gt; 0, # SPH_FILTER_VALUES       :range        =&gt; 1, # SPH_FILTER_RANGE       :float_range  =&gt; 2</td>
        </tr>
        </table>
      </div>
    </div>



    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">anchor</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">connection</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">cut_off</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">field_weights</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">filters</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">group_by</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">group_clause</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">group_distinct</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">group_function</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">id_range</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">index_weights</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">limit</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">match_mode</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">max_matches</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">max_query_time</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">offset</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">overrides</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">port</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">queue</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">rank_mode</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">retry_count</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">retry_delay</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">select</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">server</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">sort_by</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">sort_mode</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">timeout</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">weights</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000334" class="method-detail">
        <a name="M000334"></a>

        <div class="method-heading">
          <a href="Client.src/M000334.html" target="Code" class="method-signature"
            onclick="popupCode('Client.src/M000334.html');return false;">
          <span class="method-name">connection</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000333" class="method-detail">
        <a name="M000333"></a>

        <div class="method-heading">
          <a href="Client.src/M000333.html" target="Code" class="method-signature"
            onclick="popupCode('Client.src/M000333.html');return false;">
          <span class="method-name">connection=</span><span class="method-args">(value)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000335" class="method-detail">
        <a name="M000335"></a>

        <div class="method-heading">
          <a href="Client.src/M000335.html" target="Code" class="method-signature"
            onclick="popupCode('Client.src/M000335.html');return false;">
          <span class="method-name">new</span><span class="method-args">(server=nil, port=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Can instantiate with a specific server and port - otherwise it assumes
defaults of localhost and 3312 respectively. All other settings can be
accessed and changed via the attribute accessors.
</p>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000345" class="method-detail">
        <a name="M000345"></a>

        <div class="method-heading">
          <a href="Client.src/M000345.html" target="Code" class="method-signature"
            onclick="popupCode('Client.src/M000345.html');return false;">
          <span class="method-name">add_override</span><span class="method-args">(attribute, type, values)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000338" class="method-detail">
        <a name="M000338"></a>

        <div class="method-heading">
          <a href="Client.src/M000338.html" target="Code" class="method-signature"
            onclick="popupCode('Client.src/M000338.html');return false;">
          <span class="method-name">append_query</span><span class="method-args">(search, index = '*', comments = '')</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Append a <a href="Client.html#M000340">query</a> to the queue. This uses
the same parameters as the <a href="Client.html#M000340">query</a> method.
</p>
        </div>
      </div>

      <div id="method-M000347" class="method-detail">
        <a name="M000347"></a>

        <div class="method-heading">
          <a href="Client.src/M000347.html" target="Code" class="method-signature"
            onclick="popupCode('Client.src/M000347.html');return false;">
          <span class="method-name">close</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000341" class="method-detail">
        <a name="M000341"></a>

        <div class="method-heading">
          <a href="Client.src/M000341.html" target="Code" class="method-signature"
            onclick="popupCode('Client.src/M000341.html');return false;">
          <span class="method-name">excerpts</span><span class="method-args">(options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Build <a href="Client.html#M000341">excerpts</a> from search terms (the
<tt>words</tt>) and the text of documents. Excerpts are bodies of text that
have the <tt>words</tt> highlighted. They may also be abbreviated to fit
within a word limit.
</p>
<p>
As part of the options hash, you will need to define:
</p>
<ul>
<li>:docs

</li>
<li>:words

</li>
<li>:index

</li>
</ul>
<p>
Optional settings include:
</p>
<ul>
<li>:before_match (defaults to &lt;span class=&quot;match&quot;&gt;)

</li>
<li>:after_match (defaults to &lt;/span&gt;)

</li>
<li>:chunk_separator (defaults to &#8217; &amp;8230; &#8217; - which is an HTML
ellipsis)

</li>
<li>:limit (defaults to 256)

</li>
<li>:around (defaults to 5)

</li>
<li>:exact_phrase (defaults to false)

</li>
<li>:single_passage (defaults to false)

</li>
</ul>
<p>
The defaults differ from the official PHP client, as I&#8216;ve opted for
semantic HTML markup.
</p>
<p>
Example:
</p>
<pre>
  client.excerpts(:docs =&gt; [&quot;Pat Allan, Pat Cash&quot;], :words =&gt; 'Pat', :index =&gt; 'pats')
  #=&gt; [&quot;&lt;span class=\&quot;match\&quot;&gt;Pat&lt;/span&gt; Allan, &lt;span class=\&quot;match\&quot;&gt;Pat&lt;/span&gt; Cash&quot;]

  lorem_lipsum = &quot;Lorem ipsum dolor...&quot;

  client.excerpts(:docs =&gt; [&quot;Pat Allan, #{lorem_lipsum} Pat Cash&quot;], :words =&gt; 'Pat', :index =&gt; 'pats')
  #=&gt; [&quot;&lt;span class=\&quot;match\&quot;&gt;Pat&lt;/span&gt; Allan, Lorem ipsum dolor sit amet, consectetur adipisicing
         elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua &amp;#8230; . Excepteur
         sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est
         laborum. &lt;span class=\&quot;match\&quot;&gt;Pat&lt;/span&gt; Cash&quot;]
</pre>
<p>
Workflow:
</p>
<p>
Excerpt creation is completely isolated from searching the index. The
nominated index is only used to discover encoding and charset information.
</p>
<p>
Therefore, the workflow goes:
</p>
<ol>
<li>Do the sphinx <a href="Client.html#M000340">query</a>.

</li>
<li>Fetch the documents found by sphinx from their repositories.

</li>
<li>Pass the documents&#8217; text to <tt><a
href="Client.html#M000341">excerpts</a></tt> for marking up of matched
terms.

</li>
</ol>
        </div>
      </div>

      <div id="method-M000343" class="method-detail">
        <a name="M000343"></a>

        <div class="method-heading">
          <a href="Client.src/M000343.html" target="Code" class="method-signature"
            onclick="popupCode('Client.src/M000343.html');return false;">
          <span class="method-name">keywords</span><span class="method-args">(query, index, return_hits = false)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Generates a keyword list for a given <a
href="Client.html#M000340">query</a>. Each keyword is represented by a
hash, with keys :tokenised and :normalised. If return_hits is set to true
it will also report on the number of hits and documents for each keyword
(see :hits and :docs keys respectively).
</p>
        </div>
      </div>

      <div id="method-M000346" class="method-detail">
        <a name="M000346"></a>

        <div class="method-heading">
          <a href="Client.src/M000346.html" target="Code" class="method-signature"
            onclick="popupCode('Client.src/M000346.html');return false;">
          <span class="method-name">open</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000340" class="method-detail">
        <a name="M000340"></a>

        <div class="method-heading">
          <a href="Client.src/M000340.html" target="Code" class="method-signature"
            onclick="popupCode('Client.src/M000340.html');return false;">
          <span class="method-name">query</span><span class="method-args">(search, index = '*', comments = '')</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Query the Sphinx daemon - defaulting to all indexes, but you can specify a
specific one if you wish. The search parameter should be a string following
Sphinx&#8216;s expectations.
</p>
<p>
The object returned from this method is a hash with the following keys:
</p>
<ul>
<li>:matches

</li>
<li>:fields

</li>
<li>:attributes

</li>
<li>:attribute_names

</li>
<li>:words

</li>
<li>:total

</li>
<li>:total_found

</li>
<li>:time

</li>
<li>:<a href="Client.html#M000344">status</a>

</li>
<li>:warning (if appropriate)

</li>
<li>:error (if appropriate)

</li>
</ul>
<p>
The key <tt>:matches</tt> returns an array of hashes - the actual search
results. Each hash has the document id (<tt>:doc</tt>), the result
weighting (<tt>:weight</tt>), and a hash of the attributes for the document
(<tt>:attributes</tt>).
</p>
<p>
The <tt>:fields</tt> and <tt>:attribute_names</tt> keys return list of
fields and attributes for the documents. The key <tt>:attributes</tt> will
return a hash of attribute name and type pairs, and <tt>:words</tt> returns
a hash of hashes representing the words from the search, with the number of
documents and hits for each, along the lines of:
</p>
<pre>
  results[:words][&quot;Pat&quot;] #=&gt; {:docs =&gt; 12, :hits =&gt; 15}
</pre>
<p>
<tt>:total</tt>, <tt>:total_found</tt> and <tt>:time</tt> return the number
of matches available, the total number of matches (which may be greater
than the maximum available, depending on the number of matches and your
sphinx configuration), and the time in milliseconds that the <a
href="Client.html#M000340">query</a> took to <a
href="Client.html#M000339">run</a>.
</p>
<p>
<tt>:<a href="Client.html#M000344">status</a></tt> is the error code for
the <a href="Client.html#M000340">query</a> - and if there was a related
warning, it will be under the <tt>:warning</tt> key. Fatal errors will be
described under <tt>:error</tt>.
</p>
        </div>
      </div>

      <div id="method-M000336" class="method-detail">
        <a name="M000336"></a>

        <div class="method-heading">
          <a href="Client.src/M000336.html" target="Code" class="method-signature"
            onclick="popupCode('Client.src/M000336.html');return false;">
          <span class="method-name">reset</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Reset attributes and settings to defaults.
</p>
        </div>
      </div>

      <div id="method-M000339" class="method-detail">
        <a name="M000339"></a>

        <div class="method-heading">
          <a href="Client.src/M000339.html" target="Code" class="method-signature"
            onclick="popupCode('Client.src/M000339.html');return false;">
          <span class="method-name">run</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Run all the queries currently in the queue. This will return an array of
results hashes.
</p>
        </div>
      </div>

      <div id="method-M000337" class="method-detail">
        <a name="M000337"></a>

        <div class="method-heading">
          <a href="Client.src/M000337.html" target="Code" class="method-signature"
            onclick="popupCode('Client.src/M000337.html');return false;">
          <span class="method-name">set_anchor</span><span class="method-args">(lat_attr, lat, long_attr, long)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Set the geo-anchor point - with the names of the attributes that contain
the latitude and longitude (in radians), and the reference position. Note
that for geocoding to work properly, you must also set match_mode to
:extended. To sort results by distance, you will need to set sort_mode to
&#8217;@geodist asc&#8217; for example. Sphinx expects latitude and
longitude to be returned from you SQL source in radians.
</p>
<p>
Example:
</p>
<pre>
  client.set_anchor('lat', -0.6591741, 'long', 2.530770)
</pre>
        </div>
      </div>

      <div id="method-M000344" class="method-detail">
        <a name="M000344"></a>

        <div class="method-heading">
          <a href="Client.src/M000344.html" target="Code" class="method-signature"
            onclick="popupCode('Client.src/M000344.html');return false;">
          <span class="method-name">status</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000342" class="method-detail">
        <a name="M000342"></a>

        <div class="method-heading">
          <a href="Client.src/M000342.html" target="Code" class="method-signature"
            onclick="popupCode('Client.src/M000342.html');return false;">
          <span class="method-name">update</span><span class="method-args">(index, attributes, values_by_doc)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Update attributes - first parameter is the relevant index, second is an
array of attributes to be updated, and the third is a hash, where the keys
are the document ids, and the values are arrays with the attribute values -
in the same order as the second parameter.
</p>
<p>
Example:
</p>
<pre>
  client.update('people', ['birthday'], {1 =&gt; [Time.at(1982, 20, 8).to_i]})
</pre>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>